
# 3D Band Structure Workflow for VASP

This repository provides a complete Python-based workflow to generate and visualize **3D band structure surfaces** from **VASP** simulations. It is especially useful for large supercells (such as graphene + COF systems), where accurate resolution of small band gaps and Dirac cone features is critical.

---

## 📁 Contents

| File | Description |
|------|-------------|
| `kpoints_gui_weighted.py` | GUI tool for creating custom or weighted k-point meshes, including Dirac-cone refinement. |
| `kpoints_grid.py`         | Extracts k-point coordinates and HOMO/LUMO band energies from VASP outputs and generates `.grd` files for plotting. |
| `visualization.py`        | Visualizes the band surface data from `.grd` files as 2D or 3D energy surfaces. GUI mode can be activated|

---

## 🧪 Workflow Overview

This workflow proceeds in four main steps:

1. Generate a custom k-point mesh with a GUI
2. Run a VASP band structure calculation
3. Extract structured grid data (k-points and bands)
4. Visualize the 3D band surfaces (HOMO and LUMO)

---

## 🔹 Step 1: Generate Weighted KPOINTS File

Run:

```bash
python3 kpoints_gui_weighted.py
```

### 🎛️ GUI Features:

- Define `kx`, `ky`, and `kz` grid dimensions (e.g., `20×20×1`)
- Add **refined sampling** around high-symmetry points (e.g., Γ, K, or M) — useful for capturing Dirac cones or flat bands
- Option to **weight k-points** (for denser sampling in select regions) or generate a **uniform grid**
- Preview k-point grid before export
- Export a standard VASP-compatible `KPOINTS` file with weighted or uniform entries

📄 **Output:** A `KPOINTS` file to be used directly in a VASP run.

---

## 🔹 Step 2: Run VASP Calculation

Use the generated `KPOINTS` file in your simulation directory and configure your `INCAR` file appropriately.

Ensure your VASP run produces the following outputs:

- `EIGENVAL` — Band energies
- `KPOINTS` — The k-point mesh used
- `FERMI_ENERGY` — A single-line text file containing the Fermi level in eV (can be manually extracted from `OUTCAR` or generated by vaspkit)
- `WAVECAR`, `CHGCAR` — For reuse if needed

---

## 🔹 Step 3: Extract Grid Data for Visualization

After your VASP run completes, execute:

```bash
python3 kpoints_grid.py
```

### 📦 Outputs:

- `KX.grd`, `KY.grd`: Meshgrid of reciprocal-space k-points
- `BAND_HOMO.grd`: Energy values of the HOMO band at each k-point
- `BAND_LUMO.grd`: Energy values of the LUMO band at each k-point

✅ If `FERMI_ENERGY` is provided, the energies are shifted relative to the Fermi level.

---

## 🔹 Step 4: Visualize 3D Band Surfaces

Run:

```bash
python3 visualization.py
```

This script loads the `.grd` files and produces 2D and 3D visualizations of the band structure.

### 📊 Features:

- 3D surface plots for `BAND_HOMO` and `BAND_LUMO` over k-space
- GUI mode for zooming in and out, rotation, saving pictures, and so on.
- Visual comparison of conduction and valence band features
- Detection of band gap size and location
- Visualization of Dirac cone behavior or flat band regions
- Optional export or saving of plots

---

## 📥 Requirements

Install dependencies:

```bash
pip install numpy matplotlib pyvista
```

Also requires:
- `tkinter` (for GUI; comes preinstalled with most Python distributions)

---

## 📂 File Summary

| File | Purpose |
|------|---------|
| `kpoints_gui_weighted.py` | GUI to generate custom KPOINTS file |
| `KPOINTS` | Input for VASP, generated by GUI |
| `EIGENVAL` | VASP output containing band energies |
| `FERMI_ENERGY` | Optional file containing the Fermi level |
| `kpoints_grid.py` | Extracts band surfaces from VASP output |
| `KX.grd`, `KY.grd` | 2D meshgrid of k-point coordinates |
| `BAND_HOMO.grd`, `BAND_LUMO.grd` | Band energies at each k-point |
| `visualization.py` | Visualizes the band surfaces as 2D/3D plots |

---

## 📄 License

MIT License – Free to use, modify, and redistribute with attribution.

---

## 👨‍💻 Author

Developed by Shuangjie Zhao.
